# -*- coding: utf-8 -*-
"""sfp_deep_pc1.ipynb
Automatically generated by Colaboratory.
"""

from tensorflow import keras
import numpy as np
from sklearn.model_selection import train_test_split
from google.colab import drive

drive.mount("/content/drive")
f = open("",'r')
# 1109
instances = f.readlines()
data = []
label = []
for instance in instances:
  record = instance.split(',')
  #save label
  if record.pop().replace("\n","") == 'true':
    label.append(0)
  else:
    label.append(1)
  #save data
  record = list(map(float,record))
  data.append(record)

data = np.array(data)
label = np.array(label)

print("PC1")
print(data)
print("data shape :", data.shape)
print("label shape :", label.shape)
f.close()

x_train, x_test, y_train, y_test = train_test_split(data,label,test_size=0.2, random_state=0)
print("train, test data split...")
print("x_train shape :", x_train.shape, ", y_train shape :", y_train.shape)
print("x_test shape :", x_test.shape, ", y_test shape :", y_test.shape)

#deep learning part
model = tf.keras.Sequential([
    tf.keras.layers.Dense(128, activation='relu',input_shape=(21,)),
    tf.keras.layers.Dropout(0.2),
    tf.keras.layers.Dense(128, activation='relu'),
    tf.keras.layers.Dropout(0.2),
    tf.keras.layers.Dense(64, activation='relu'),
    tf.keras.layers.Dropout(0.2),
    tf.keras.layers.Dense(64, activation='relu'),
    tf.keras.layers.Dense(1,activation='sigmoid')
])
opt = tf.keras.optimizers.Adam(learning_rate=0.001)
model.compile(optimizer=opt,
              loss='binary_crossentropy',
              metrics=['accuracy',tf.keras.metrics.AUC()])
model.summary()
model.fit(x_train,y_train, batch_size=5 ,epochs=1000)
model.evaluate(x_test,y_test)